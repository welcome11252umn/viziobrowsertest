<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SmartTV Browser with UI & User-Agent</title>
<style>
  body, html {
    margin: 0; padding: 0; height: 100%; overflow: hidden; background: black; color: white;
    font-family: sans-serif;
  }
  #topbar {
    display: flex;
    align-items: center;
    padding: 6px 10px;
    background: #111;
    gap: 10px;
  }
  #urlInput {
    flex-grow: 1;
    background: #222;
    border: none;
    color: white;
    font-size: 1.1em;
    padding: 6px 8px;
    border-radius: 4px;
  }
  #urlInput:focus {
    outline: 2px solid #4af;
    background: #333;
  }
  button, select {
    background: #222;
    border: none;
    color: white;
    font-size: 1em;
    padding: 6px 10px;
    border-radius: 4px;
    cursor: pointer;
  }
  button:hover, select:hover {
    background: #444;
  }
  #cursor {
    position: absolute;
    width: 20px; height: 20px;
    background: white;
    border-radius: 50%;
    pointer-events: none;
    z-index: 9999;
    transition: transform 0.05s linear;
  }
  #viewer {
    position: absolute;
    top: 44px; /* height of top bar + padding */
    left: 0;
    width: 100vw;
    height: calc(100vh - 44px);
    border: none;
  }
  #menuPanel {
    position: absolute;
    top: 44px;
    right: 10px;
    width: 280px;
    background: #222;
    border-radius: 8px;
    padding: 12px;
    display: none;
    z-index: 10000;
    font-size: 0.9em;
  }
  #menuPanel h2 {
    margin-top: 0;
    font-weight: 700;
    margin-bottom: 8px;
  }
  #keyboard {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: #222;
    border-radius: 8px;
    padding: 10px;
    display: none;
    z-index: 10001;
    user-select: none;
  }
  #keyboard button {
    background: #444;
    border: none;
    margin: 2px;
    padding: 12px 15px;
    font-size: 1.1em;
    border-radius: 4px;
    cursor: pointer;
    user-select: none;
  }
  #keyboard button:hover {
    background: #666;
  }
</style>
</head>
<body>

<div id="topbar">
  <input id="urlInput" type="text" placeholder="Enter URL here (e.g. https://tiktok.com)" />
  <select id="clientSelector" title="Select Browser Client">
    <option value="tv">TV Client</option>
    <option value="desktop">Desktop Client</option>
    <option value="mobile">Mobile Client</option>
  </select>
  <button id="menuBtn">Menu</button>
</div>

<div id="menuPanel">
  <h2>Browser Info</h2>
  <p><b>Version:</b> 1.1</p>
  <p><b>Features:</b></p>
  <ul>
    <li>Smooth remote control cursor</li>
    <li>URL input with keyboard support</li>
    <li>User agent switching: TV / Desktop / Mobile</li>
    <li>Info menu with credits</li>
  </ul>
  <p><b>Credits:</b> Powered by ChatGPT & Vizio hacking community</p>
  <button id="closeMenuBtn">Close</button>
</div>

<iframe id="viewer" src="https://www.tiktok.com" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
<div id="cursor"></div>

<!-- On-screen Keyboard -->
<div id="keyboard"></div>

<script>
  // --- Cursor Setup ---
  const cursor = document.getElementById("cursor");
  let posX = window.innerWidth / 2;
  let posY = window.innerHeight / 2;
  const speed = 4;
  let keys = {
    ArrowUp: false,
    ArrowDown: false,
    ArrowLeft: false,
    ArrowRight: false
  };

  function updateCursor() {
    if (keys.ArrowUp) posY -= speed;
    if (keys.ArrowDown) posY += speed;
    if (keys.ArrowLeft) posX -= speed;
    if (keys.ArrowRight) posX += speed;

    posX = Math.max(0, Math.min(window.innerWidth - 20, posX));
    posY = Math.max(44, Math.min(window.innerHeight - 20, posY)); // keep under topbar

    cursor.style.transform = `translate(${posX}px, ${posY}px)`;
  }

  setInterval(updateCursor, 16); // ~60fps

  document.addEventListener("keydown", (e) => {
    if (e.key in keys) keys[e.key] = true;

    if (e.key === "Enter") {
      const el = document.elementFromPoint(posX + 10, posY + 10);
      if (el) el.click();
    }
  });

  document.addEventListener("keyup", (e) => {
    if (e.key in keys) keys[e.key] = false;
  });

  window.addEventListener('resize', () => {
    posX = window.innerWidth / 2;
    posY = window.innerHeight / 2;
  });

  // --- Menu Logic ---
  const menuBtn = document.getElementById('menuBtn');
  const menuPanel = document.getElementById('menuPanel');
  const closeMenuBtn = document.getElementById('closeMenuBtn');

  menuBtn.addEventListener('click', () => {
    menuPanel.style.display = 'block';
  });

  closeMenuBtn.addEventListener('click', () => {
    menuPanel.style.display = 'none';
  });

  // --- URL Input + Keyboard Logic ---
  const urlInput = document.getElementById('urlInput');
  const keyboard = document.getElementById('keyboard');
  const viewer = document.getElementById('viewer');

  // User Agent strings for simulation
  const userAgents = {
    tv: "Mozilla/5.0 (Linux; U; Android 9; en-US; Vizio SmartCast TV Build/TVUserAgent) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/69.0.3497.128 Safari/537.36",
    desktop: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
    mobile: "Mozilla/5.0 (Linux; Android 11; Mobile) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Mobile Safari/537.36"
  };

  // Current user agent setting
  let currentUA = userAgents.tv;

  // Function to create a proxy page to override user agent and load the real URL
  function createProxyPage(url, ua) {
    // We generate a data URI page that sets userAgent via JS override
    // Note: true UA override isn't possible without browser extension, but some sites respect navigator.userAgent override

    return `data:text/html;charset=utf-8,
    <html>
      <head>
        <script>
          Object.defineProperty(navigator, 'userAgent', {
            get: () => "${ua}",
            configurable: true
          });
          window.location.replace("${url}");
        </script>
      </head>
      <body></body>
    </html>`;
  }

  function loadURL(url) {
    if (!url.startsWith("http")) {
      url = "https://" + url;
    }
    viewer.src = createProxyPage(url, currentUA);
  }

  // Load initial URL
  loadURL(urlInput.value || "https://www.tiktok.com");

  // URL input focus: try system keyboard else show on-screen keyboard
  urlInput.addEventListener('focus', () => {
    // Detect if system keyboard appears (very limited in browser) — fallback immediately for TV
    setTimeout(() => {
      if (document.activeElement === urlInput) {
        showKeyboard();
      }
    }, 500);
  });

  // On-screen keyboard keys
  const keysLayout = [
    'q','w','e','r','t','y','u','i','o','p',
    'a','s','d','f','g','h','j','k','l',
    'z','x','c','v','b','n','m',
    'Backspace','Space','Enter'
  ];

  function showKeyboard() {
    keyboard.style.display = 'block';
    keyboard.innerHTML = '';
    keysLayout.forEach(k => {
      const keyBtn = document.createElement('button');
      keyBtn.textContent = k === 'Space' ? '␣' : k;
      keyBtn.style.width = k === 'Space' ? '120px' : '40px';
      keyBtn.addEventListener('click', () => {
        if (k === 'Backspace') {
          urlInput.value = urlInput.value.slice(0, -1);
        } else if (k === 'Space') {
          urlInput.value += ' ';
        } else if (k === 'Enter') {
          hideKeyboard();
          loadURL(urlInput.value.trim());
          urlInput.blur();
        } else {
          urlInput.value += k;
        }
        urlInput.focus();
      });
      keyboard.appendChild(keyBtn);
    });
  }

  function hideKeyboard() {
    keyboard.style.display = 'none';
  }

  // Hide keyboard when URL input loses focus
  urlInput.addEventListener('blur', () => {
    setTimeout(hideKeyboard, 200);
  });

  // Handle user agent selection
  const clientSelector = document.getElementById('clientSelector');
  clientSelector.addEventListener('change', () => {
    currentUA = userAgents[clientSelector.value] || userAgents.tv;
    loadURL(urlInput.value.trim() || "https://www.tiktok.com");
  });

  // Load URL on pressing Enter in input box
  urlInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      loadURL(urlInput.value.trim());
      urlInput.blur();
      hideKeyboard();
    }
  });

  // Cursor click support for iframe interaction
  document.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      const el = document.elementFromPoint(posX + 10, posY + 10);
      if (el && el.tagName !== 'IFRAME') el.click();
      // For iframe clicks, inject a synthetic click inside iframe if possible (limited by cross-origin)
    }
  });
</script>

</body>
</html>
