<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SmartTV Browser with UI & User-Agent</title>
<style>
  body, html {
    margin: 0; padding: 0; height: 100%; overflow: hidden; background: black; color: white;
    font-family: sans-serif;
  }
  #topbar {
    display: flex;
    align-items: center;
    padding: 6px 10px;
    background: #111;
    gap: 10px;
  }
  #urlInput {
    flex-grow: 1;
    background: #222;
    border: none;
    color: white;
    font-size: 1.1em;
    padding: 6px 8px;
    border-radius: 4px;
  }
  #urlInput:focus {
    outline: 2px solid #4af;
    background: #333;
  }
  button, select {
    background: #222;
    border: none;
    color: white;
    font-size: 1em;
    padding: 6px 10px;
    border-radius: 4px;
    cursor: pointer;
  }
  button:hover, select:hover {
    background: #444;
  }
  #cursor {
    position: absolute;
    width: 20px; height: 20px;
    background: white;
    border-radius: 50%;
    pointer-events: none;
    z-index: 9999;
    transition: transform 0.05s linear;
  }
  #viewer {
    position: absolute;
    top: 44px; /* height of top bar + padding */
    left: 0;
    width: 100vw;
    height: calc(100vh - 44px);
    border: none;
  }
  #menuPanel {
    position: absolute;
    top: 44px;
    right: 10px;
    width: 280px;
    background: #222;
    border-radius: 8px;
    padding: 12px;
    display: none;
    z-index: 10000;
    font-size: 0.9em;
  }
  #menuPanel h2 {
    margin-top: 0;
    font-weight: 700;
    margin-bottom: 8px;
  }
  #keyboard {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: #222;
    border-radius: 8px;
    padding: 10px;
    display: none;
    z-index: 10001;
    user-select: none;
  }
  #keyboard button {
    background: #444;
    border: none;
    margin: 2px;
    padding: 12px 15px;
    font-size: 1.1em;
    border-radius: 4px;
    cursor: pointer;
    user-select: none;
  }
  #keyboard button:hover {
    background: #666;
  }
  /* Selection box style */
  #selectionBox {
    position: absolute;
    border: 3px solid #4af;
    border-radius: 6px;
    pointer-events: none;
    transition: all 0.15s ease;
    box-sizing: border-box;
    z-index: 100000;
    display: none;
  }
</style>
</head>
<body>

<div id="topbar">
  <input id="urlInput" type="text" placeholder="Enter URL here (e.g. https://tiktok.com)" />
  <select id="clientSelector" title="Select Browser Client">
    <option value="tv">TV Client</option>
    <option value="desktop">Desktop Client</option>
    <option value="mobile">Mobile Client</option>
  </select>
  <button id="menuBtn">Menu</button>
</div>

<div id="menuPanel">
  <h2>Browser Info</h2>
  <p><b>Version:</b> 1.1</p>
  <p><b>Features:</b></p>
  <ul>
    <li>Smooth remote control cursor</li>
    <li>URL input with keyboard support</li>
    <li>User agent switching: TV / Desktop / Mobile</li>
    <li>Info menu with credits</li>
  </ul>
  <p><b>Credits:</b> Powered by ChatGPT & Vizio hacking community</p>
  <button id="closeMenuBtn">Close</button>
</div>

<iframe id="viewer" src="https://www.tiktok.com" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
<div id="cursor"></div>
<div id="selectionBox"></div>

<!-- On-screen Keyboard -->
<div id="keyboard"></div>

<script>
 // --- Cursor Setup ---
const cursor = document.getElementById("cursor");
let posX = window.innerWidth / 2;
let posY = window.innerHeight / 2;
const speed = 8; // a bit faster, adjust as needed

// Track which keys are pressed
const keys = new Set();

// Use requestAnimationFrame for smooth updates
function updateCursor() {
  if (keys.has("ArrowUp")) posY -= speed;
  if (keys.has("ArrowDown")) posY += speed;
  if (keys.has("ArrowLeft")) posX -= speed;
  if (keys.has("ArrowRight")) posX += speed;

  posX = Math.min(Math.max(0, posX), window.innerWidth - 20);
  posY = Math.min(Math.max(44, posY), window.innerHeight - 20);

  cursor.style.transform = `translate(${posX}px, ${posY}px)`;

  requestAnimationFrame(updateCursor);
}

// Start the loop
requestAnimationFrame(updateCursor);

// Listen for keydown and keyup events for cursor movement
document.addEventListener("keydown", (e) => {
  if (["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)) {
    keys.add(e.key);
    e.preventDefault(); // prevent default scrolling or other actions
  }
  if (e.key === "Enter") {
    // Try clicking the element under cursor
    const el = document.elementFromPoint(posX + 10, posY + 10);
    if (el) {
      el.click();
    }
  }
});

document.addEventListener("keyup", (e) => {
  if (keys.has(e.key)) {
    keys.delete(e.key);
    e.preventDefault();
  }
});

// On window resize, reset cursor to center-ish
window.addEventListener('resize', () => {
  posX = window.innerWidth / 2;
  posY = window.innerHeight / 2;
});

// --- Selection box & keyboard navigation ---

const selectionBox = document.getElementById("selectionBox");

// The elements to cycle focus through in order:
const focusableElems = [
  document.getElementById("urlInput"),
  document.getElementById("clientSelector"),
  document.getElementById("menuBtn"),
  document.getElementById("closeMenuBtn")
];

let focusIndex = 0;

function updateSelectionBox() {
  const el = focusableElems[focusIndex];
  if (!el) {
    selectionBox.style.display = "none";
    return;
  }
  const rect = el.getBoundingClientRect();
  selectionBox.style.display = "block";
  selectionBox.style.width = rect.width + 8 + "px";  // padding for border
  selectionBox.style.height = rect.height + 8 + "px";
  selectionBox.style.left = (rect.left - 4) + "px";  // offset for border
  selectionBox.style.top = (rect.top - 4) + "px";
}

// Initialize selection box on page load
updateSelectionBox();

document.addEventListener("keydown", (e) => {
  // Only handle keys for selection navigation if input is NOT focused
  const active = document.activeElement;
  if (active && (active.id === "urlInput" || active.id === "clientSelector")) {
    // Let normal typing happen if input/select is focused
    return;
  }

  if (["ArrowLeft", "ArrowUp"].includes(e.key)) {
    e.preventDefault();
    focusIndex--;
    if (focusIndex < 0) focusIndex = focusableElems.length - 1;
    updateSelectionBox();
  } else if (["ArrowRight", "ArrowDown"].includes(e.key)) {
    e.preventDefault();
    focusIndex++;
    if (focusIndex >= focusableElems.length) focusIndex = 0;
    updateSelectionBox();
  } else if (e.key === "Enter") {
    e.preventDefault();
    const el = focusableElems[focusIndex];
    if (!el) return;

    if (el.tagName === "INPUT" || el.tagName === "SELECT") {
      el.focus();
      // Optionally open the select dropdown (some browsers open it on focus)
      if (el.tagName === "SELECT") {
        const event = new MouseEvent('mousedown', { bubbles: true });
        el.dispatchEvent(event);
      }
    } else if (el.tagName === "BUTTON") {
      el.click();
    }
  }
});
</script>

</body>
</html>
